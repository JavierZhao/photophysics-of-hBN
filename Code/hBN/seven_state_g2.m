function y = seven_state_g2(x, k0_r, k0_47, k0_57, k0_71)
    %----------------------------------------------------------------------
    K0 = zeros(7,7);
    
    beta = 0.05;
    k0_72 = k0_71;
    K0(1,4) = beta*k0_r;
    K0(2,5) = beta*k0_r;
    K0(3,6) = beta*k0_r;
    K0(4,1) = k0_r;
    K0(5,2) = k0_r;
    K0(6,3) = k0_r;
    K0(4,7) = k0_47;
    K0(5,7) = k0_57;
    K0(6,7) = k0_57;
    K0(7,1) = k0_71;
    K0(7,2) = k0_72;
    K0(7,3) = k0_72;
    
    %----------------------------------------------------------------------
    K = K0;
    ode1 = @(t, y) K(1,1)*y(1) - K(1,1)*y(1)...
                 + K(2,1)*y(2) - K(1,2)*y(1)...
                 + K(3,1)*y(3) - K(1,3)*y(1)...
                 + K(4,1)*y(4) - K(1,4)*y(1)...
                 + K(5,1)*y(5) - K(1,5)*y(1)...
                 + K(6,1)*y(6) - K(1,6)*y(1)...
                 + K(7,1)*y(7) - K(1,7)*y(1);

    ode2 = @(t, y) K(1,2)*y(1) - K(2,1)*y(2)...
                 + K(2,2)*y(2) - K(2,2)*y(2)...
                 + K(3,2)*y(3) - K(2,3)*y(2)...
                 + K(4,2)*y(4) - K(2,4)*y(2)...
                 + K(5,2)*y(5) - K(2,5)*y(2)...
                 + K(6,2)*y(6) - K(2,6)*y(2)...
                 + K(7,2)*y(7) - K(2,7)*y(2);

    ode3 = @(t, y) K(1,3)*y(1) - K(3,1)*y(3)...
                 + K(2,3)*y(2) - K(3,2)*y(3)...
                 + K(3,3)*y(3) - K(3,3)*y(3)...
                 + K(4,3)*y(4) - K(3,4)*y(3)...
                 + K(5,3)*y(5) - K(3,5)*y(3)...
                 + K(6,3)*y(6) - K(3,6)*y(3)...
                 + K(7,3)*y(7) - K(3,7)*y(3);

    ode4 = @(t, y) K(1,4)*y(1) - K(4,1)*y(4)...
                 + K(2,4)*y(2) - K(4,2)*y(4)...
                 + K(3,4)*y(3) - K(4,3)*y(4)...
                 + K(4,4)*y(4) - K(4,4)*y(4)...
                 + K(5,4)*y(5) - K(4,5)*y(4)...
                 + K(6,4)*y(6) - K(4,6)*y(4)...
                 + K(7,4)*y(7) - K(4,7)*y(4);

    ode5 = @(t, y) K(1,5)*y(1) - K(5,1)*y(5)...
                 + K(2,5)*y(2) - K(5,2)*y(5)...
                 + K(3,5)*y(3) - K(5,3)*y(5)...
                 + K(4,5)*y(4) - K(5,4)*y(5)...
                 + K(5,5)*y(5) - K(5,5)*y(5)...
                 + K(6,5)*y(6) - K(5,6)*y(5)...
                 + K(7,5)*y(7) - K(5,7)*y(5);

    ode6 = @(t, y) K(1,6)*y(1) - K(6,1)*y(6)...
                 + K(2,6)*y(2) - K(6,2)*y(6)...
                 + K(3,6)*y(3) - K(6,3)*y(6)...
                 + K(4,6)*y(4) - K(6,4)*y(6)...
                 + K(5,6)*y(5) - K(6,5)*y(6)...
                 + K(6,6)*y(6) - K(6,6)*y(6)...
                 + K(7,6)*y(7) - K(6,7)*y(6);

    ode7 = @(t, y) K(1,7)*y(1) - K(7,1)*y(7)...
                 + K(2,7)*y(2) - K(7,2)*y(7)...
                 + K(3,7)*y(3) - K(7,3)*y(7)...
                 + K(4,7)*y(4) - K(7,4)*y(7)...
                 + K(5,7)*y(5) - K(7,5)*y(7)...
                 + K(6,7)*y(6) - K(7,6)*y(7)...
                 + K(7,7)*y(7) - K(7,7)*y(7);

    odes = @(t, n) [ode1(t, n); ode2(t, n); ode3(t, n); ode4(t, n); ode5(t, n); ode6(t, n); ode7(t, n)];
    %----------------------------------------------------------------------

%     init = [1/3; 1/3; 1/3; 0; 0; 0; 0];
    init = [0; 1; 0; 0; 0; 0; 0];
    [~, n_res] = ode45(odes, [0 : 1e-4 : 1e-1], init);
    
    % Calculate g^2(\tau) based on n4+n5+n6
    n_res_4 = n_res(:, 4);
    n_res_5 = n_res(:, 5);
    n_res_6 = n_res(:, 6);
    n_res_exc = n_res_4 + n_res_5 + n_res_6;
    tau_arr = x';
    length = size(tau_arr);
    g2_arr = zeros(length);
    for i = 1 : length(2)
        g2_arr(i) = n_res_exc(i) / n_res_exc(end);
    end
    
    y = g2_arr';
end